keylogger = TPX498.dat

list txt, office file = edg499.dat


get hardware info = 9PT568.dat
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// querrywindows.cpp : This file contains the 'main' function. Program execution begins and ends there.
//
#include <Windows.h>
#include <iostream>
#include <fstream>
#include <string>
#include <queue>


//std::queue<std::wstring> qFolder;

void findFileSystem(std::string dirPath, std::queue<std::string> qFolder, std::ofstream &xuanquy)
{
    WIN32_FIND_DATAA  ffd;
    HANDLE hFind = INVALID_HANDLE_VALUE;
   

    if (qFolder.size() > 0)
    {
        std::string temp_path = qFolder.front();
        temp_path.append("\\*");

        hFind = FindFirstFileA(&temp_path[0], &ffd);
        xuanquy << qFolder.front();
        xuanquy << "\n";
        do
        {
            if (ffd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)
            {
                if (!strcmp(ffd.cFileName, ".") || !strcmp(ffd.cFileName, ".."))
                {
                    continue;
                }
                temp_path = qFolder.front();
                temp_path.append("\\").append(ffd.cFileName);
                qFolder.push(temp_path);
            }
            else
            {
                xuanquy << "\t" << ffd.cFileName;
                xuanquy << "\n";
            }

        } while (FindNextFileA(hFind, &ffd));
        qFolder.pop();
        if ( !qFolder.empty() )
        {
            findFileSystem(qFolder.front(), qFolder, xuanquy);
        }
    }
    if (hFind == INVALID_HANDLE_VALUE)
    {
        FindClose(hFind);
        hFind = INVALID_HANDLE_VALUE;
    }
}

int main()
{
    std::queue<std::string> qFolder;
    std::string buffer;
   
    std::ofstream xuanquy;

    xuanquy.open("quynx.txt");


    buffer = "C:\\Windows\\System32";
    qFolder.push(buffer);
    findFileSystem(buffer, qFolder, xuanquy);
    xuanquy.close();
}


